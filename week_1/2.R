library(sqldf)
par(mfrow=c(2,1))

#2.1
empirical_prob <- function(x){
  myEcdf = ecdf(x)
  y = myEcdf(x)
  df = data.frame(x,y)
  return(df)
}


#2.2
x = rbinom(20,5,(1/6))
print(x)


#2.3
df = empirical_prob(x)
print(df)


#2.4
plot(df$x, df$y, xlim=c(0,5), ylim=c(0,1), xlab = "???????? ????????????",
     ylab = "??????????????", main="(1) ?????????????? ??????????????", col="red", pch=16)


#2.5
y = 0:5
theory = pbinom(y,5,(1/6))
print(y)
print(theory)


#2.6
lines(y, theory, col="blue",pch=18)

legend("bottomright", 
       legend = c("??????????", "????????????"), 
       col = c("red","blue"), 
       pch = c(16,18), 
       bty = "n", 
       pt.cex = 2, 
       cex = 1.2, 
       text.col = "black", 
       inset = c(0.1, 0.1))


#2.7

newDf = data.frame(y, theory)
for(size in c(20,100,200,1000)){
  x = rbinom(size,5,(1/6))
  df = empirical_prob(x)
  df = unique(df)
  newDf = sqldf("select a.* , b.y as newCol  
                        from newDf a 
                        left join df b on a.y = b.x");
  newDf = sqldf("select a.* , abs(a.newCol - a.theory) as newCol2 from newDf a");
  newName = sprintf("%dcol",size)
  newName2 = sprintf("%dgap",size)
  colnames(newDf)[colnames(newDf) == 'newCol'] <- newName
  colnames(newDf)[colnames(newDf) == 'newCol2'] <- newName2
}
print(newDf)
#???????????? ?????? ???????????? ?????????? ?????? ???????????????? ???????????????? ???????????????? ?????????????????? ???????? ?????? ?????????? ?????????? ??????
#??????????, ???????? ?????? ???????? ?????? ???????? ?????????? ?????????? ?????? ???????????????? ???????????????? ??????????????????





#2.8

#2.8.2
x = rpois(20,2)
print(x)


#2.8.3
df = empirical_prob(x)
print(df)


#2.8.4
plot(df$x, df$y, xlim=c(0,10), ylim=c(0,1), xlab = "???????? ????????????",
     ylab = "??????????????", main="(2) ?????????????? ????????????????", col="red", pch=16)


#2.8.5
y = 0:10
theory = ppois(y,2)
print(y)
print(theory)


#2.8.6
lines(y, theory, col="blue",pch=18)

legend("bottomright", 
       legend = c("??????????", "????????????"), 
       col = c("red","blue"), 
       pch = c(16,18), 
       bty = "n", 
       pt.cex = 2, 
       cex = 1.2, 
       text.col = "black", 
       inset = c(0.1, 0.1))
